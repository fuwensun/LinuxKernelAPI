注意：
1，
fun() 要写成 fun(void)

2,
$ grep -r KERN_SOH /usr/src/linux-headers-4.15.0-22

新版
#define KERN_SOH	"\001"		/* ASCII Start Of Header */
#define KERN_SOH_ASCII	'\001'
#define KERN_EMERG	KERN_SOH "0"	/* system is unusable */
#define KERN_ALERT	KERN_SOH "1"	/* action must be taken immediately */
#define KERN_CRIT	KERN_SOH "2"	/* critical conditions */
#define KERN_ERR	KERN_SOH "3"	/* error conditions */
#define KERN_WARNING	KERN_SOH "4"	/* warning conditions */
#define KERN_NOTICE	KERN_SOH "5"	/* normal but significant condition */
#define KERN_INFO	KERN_SOH "6"	/* informational */
#define KERN_DEBUG	KERN_SOH "7"	/* debug-level messages */
#define KERN_DEFAULT	KERN_SOH "d"	/* the default kernel loglevel */


旧版
#define KERN_EMERG   "<0>"   /* system is unusable */
#define KERN_ALERT   "<1>"   /* action must be taken immediately */

3,
申明和编码要分开
//warning!
ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
     struct module *fmodule = find_module(name);
//ok!
struct module *fmodule = 0;
fmodule = find_module(name);

4,
内核符号的导出，以变量、函数为最小单位。
GPL模块可以导出“非”GPL符号（使用它的模块不会被传染GPL）。
GPL模块可以导出GPL符号（使用它的模块会被传染GPL）。
EXPORT_SYMBOL(symbol_A);
EXPORT_SYMBOL_GPL(symbol_A_GPL);
EXPORT_SYMBOL_GPL_FUTURE(symbol_A_GPL_FUTURE);



命令：
make
sudo insmod __module_address.ko 
sudo rmmod __module_address.ko
sudo dmesg -c
make && sudo insmod __module_address.ko && sudo rmmod __module_address.ko && sudo dmesg -c

grep -r KERN_SOH /usr/src/linux-headers-4.15.0-22

cat /proc/kallsyms | grep test_module
